% handle Japanese data

btemp=[0
    5.5
39.6
98.3
92.2
31.8
3.9
0.1
0]/1000;
nb=zeros(100,3);
nb(:,1)=0:99;
for i=1:7
    nb(i*5+11,2)=btemp(i)*0.4+btemp(i+1)*0.6;
    nb(i*5+12,2)=btemp(i)*0.2+btemp(i+1)*0.8;
    nb(i*5+13,2)=btemp(i+1);
    nb(i*5+14,2)=btemp(i+1)*0.8+btemp(i+2)*0.2;
    nb(i*5+15,2)=btemp(i+2)*0.4+btemp(i+1)*0.6;
end
%nb(:,2)=nb(:,2)/5;
nb(:,3)=nb(:,2);
for i=16:50
    nb(i,3)=sum(nb(i-2:i+2,2))/5;
end
br=nb(:,3);

brtrue=br; 
for i=16:50
    brtrue(i)=br(i)/(1-br(i-1)-br(i-2));
end

dm=[400 400 45.5 45.5 45.5	65.7	67.9	85.9	115.4...
    174.3	289.9	472.6	738.5	1107.1	1785.1	2826.5...
    7679.1 7679.1 7679.1 7679.1 7679.1 7679.1]/1e5;
nm=zeros(100,1);
for i=1:20
    nm(i*5-4)=dm(i)*0.4+dm(i+1)*0.6;
    nm(i*5-3)=dm(i)*0.2+dm(i+1)*0.8;
    nm(i*5-2)=dm(i+1);
    nm(i*5-1)=dm(i+1)*0.8+dm(i+2)*0.2;
    nm(i*5)=dm(i+2)*0.4+dm(i+1)*0.6;
end
drm=nm;
for i=3:98
    drm(i)=sum(nm(i-2:i+2))/5;
end

df=[400 400 18 18 18	27.4	32.3	43.7...
    59.4	94	146.7	228.6	313.1	457.8	739 ...
    1219.6	5116.7 5116.7 5116.7 5116.7 5116.7 5116.7]/1e5;
nf=zeros(100,1);
for i=1:20
    nf(i*5-4)=df(i)*0.4+df(i+1)*0.6;
    nf(i*5-3)=df(i)*0.2+df(i+1)*0.8;
    nf(i*5-2)=df(i+1);
    nf(i*5-1)=df(i+1)*0.8+df(i+2)*0.2;
    nf(i*5)=df(i+2)*0.4+df(i+1)*0.6;
end
drf=nf;
for i=3:98
    drf(i)=sum(nf(i-2:i+2))/5;
end

jppopm=[600466
596910
610326
607950
606869
615685
618234
608946
620484
620082
634159
646345
673706
692224
706716
738536
765613
772956
772660
784219
823540
834550
858862
874109
916181
955777
1005385
1020949
1004494
978672
955040
934421
916453
916005
714899
887876
830981
813476
786872
777081
784295
799822
778822
760715
800517
830052
830544
882903
932313
991960
1068508
1172217
1165232
1109956
694125
740133
901083
873685
900734
874604
796438
693530
738582
762043
758935
722261
678589
674979
654568
626884
590373
563026
535445
504578
476848
428635
366138
310938
274724
245387
243345
185705
176442
162064
147712
128978
114420
94325
78305
61055
49678
37909
28027
20789
12892
9497
6502
4425
2822
1824];

jppopf=[571186
569250
581831
581353
577957
588448
589508
580020
589798
590584
605357
616000
640697
660282
671126
704392
728441
736916
737769
746663
776798
790541
821808
841135
883936
925199
973691
995701
975953
954488
929220
915242
896745
895971
702614
869898
814511
797785
773125
763260
772350
789135
770634
751750
792179
820721
823375
881209
932586
990345
1070463
1175634
1170344
1113337
702174
761830
931715
905769
933340
911279
835779
730911
787932
815024
816659
787956
749661
755222
738010
717809
683298
666734
645390
623437
611447
578338
527533
506633
473975
438299
438440
334513
327377
307963
291128
261856
242656
211054
185204
154470
130143
104568
81375
63272
41628
32932
23296
17262
11826
8102];


save jpbrt.dat brtrue -ascii
save jppopm.dat jppopm -ascii
save jppopf.dat jppopf -ascii
save jpdrm.dat drm -ascii
save jpdrf.dat drf -ascii



